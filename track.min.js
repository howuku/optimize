"use strict";window.abRedirecting=!1,window._init&&(window.howuku=window._init);var userAgent=navigator.userAgent;!function(e,t){var n=e=>{return new URL(window.location.href).searchParams.get(e)||""},o=e=>{return e.replace(/\#[0-9]/,function(e){return e.replace("#","#\\3")}).replace(/\.[0-9]/,function(e){return e.replace(".",".\\3")})},a=(e,t,n,o)=>{var a=new XMLHttpRequest;a.open(t,e,!0),a.setRequestHeader("Content-Type","application/json;charset=UTF-8"),a.onreadystatechange=function(){this.readyState===XMLHttpRequest.DONE&&200===this.status&&o(a.responseText)},a.send(JSON.stringify(n))};window.startAbTest=(e=>{localStorage.setItem("_abcache",e);let t=(e,t)=>{let n=null;if("string"==typeof e)try{e=JSON.parse(e)}catch(e){return null}return e&&e[t]&&(e[t].vaId||0===e[t].vaId)&&(n=e[t].vaId),n},a=async(e,t,n,o=null,a)=>{""===t&&(t="-1");let r=0;function i(e){try{return!(0===Object.keys(e).length&&e.constructor===Object)}catch(e){return!1}}let l=!1,c=[];window.location.href.includes("howuku.com")&&console.log("window.abdata",window.abdata);for(let e=0;e<window.abdata.length;e++)if(i(window.abdata[e].condition)){window.location.href.includes("howuku.com")&&console.log("has condition",window.abdata[e].condition),l=!0;let t=window.abdata[e].condition;if(t.url)for(let n=0;n<t.url.length;n++)if(window.location.href.toString().includes(t.url[n])){c.push(window.abdata[e].name);break}if(t.referrer)for(let n=0;n<t.referrer.length;n++)if(document.referrer.toString().includes(t.referrer[n])){c.push(window.abdata[e].name);break}if(t.preferred_country)for(let n=0;n<t.preferred_country.length;n++)if(o===t.preferred_country[n]){c.push(window.abdata[e].name);break}if(t.showToAll&&!0===t.showToAll){c.push(window.abdata[e].name);break}}if(!l)for(let e=0;e<window.abdata.length;e++)c.push(window.abdata[e].name);var d=c;window.location.href.includes("howuku.com")&&console.log("variantList",c),l||d.push("-1"),window.location.href.includes("howuku.com")&&console.log("variantList2",d),window.location.href.includes("howuku.com")&&console.log("lastVariant",t),0===Number(t)&&(t="-1");var u=d.indexOf(t);!l&&u>=0&&d.splice(u,1);let s,w=await async function(){const e=`${navigator.userAgent}${navigator.language}${Intl.DateTimeFormat().resolvedOptions().timeZone}${window.screen.height}${window.screen.width}${window.screen.colorDepth}${navigator.platform}`;return await async function(e){const t=(new TextEncoder).encode(e),n=await crypto.subtle.digest("SHA-256",t);return Array.from(new Uint8Array(n)).map(e=>e.toString(16).padStart(2,"0")).join("")}(e)}();window.location.href.includes("howuku.com")&&console.log(w);let h=function(e,t=100){return function(e){const t=BigInt("0x"+e);let n=Number(t%BigInt(Number.MAX_SAFE_INTEGER));const o=Math.random;Math.random=function(){const e=1e4*Math.sin(n++);return e-Math.floor(e)};const a=(r=1,i=101,Math.floor(Math.random()*(i-r)+r));var r,i;return Math.random=o,a}(e)<=t}(w,Number(a));window.location.href.includes("howuku.com")&&console.log("Experiment allocation isAllowed?"),window.location.href.includes("howuku.com")&&console.log(h),h&&(s=1===d.length?d[0]:d[~~((e=>t=>(2**31-1&(e=Math.imul(16807,e)))/2**31)((e=>Math.imul(e,2654435761)>>>0)(e))()*d.length)]);let m=null;for(let e in window.abdata)if(window.abdata[e].name===s){r=window.abdata[e].name,m=window.abdata[e].data;break}let f={};try{localStorage.getItem("_variant_result")&&(f=JSON.parse(localStorage.getItem("_variant_result")))}catch(e){}try{f&&(f[n]||(f[n]={vaId:r}),window.vaId=JSON.stringify(f),localStorage.setItem("_variant_result",JSON.stringify(f)))}catch(e){}};function r(e){var t=e.parentNode;return(e.scrollTop||t.scrollTop)/(t.scrollHeight-t.clientHeight)*100}let i=null;try{i=JSON.parse(e)}catch(e){}if(e&&i){function l(e){return"string"==typeof e?e.replace(/^www\./g,"").replace(/\/$/g,""):e}for(let e=0;e<i.length;e++){let b=i[e],v=b.test_id,_=new URLSearchParams(window.location.search),k=_.get("test-preview")||null,S=_.get("test-variant")||null;if((!k||Number(v)===Number(k))&&(k&&Number(v)===Number(k)&&console.log("preview id",v),b)){var c=window.location.hostname+window.location.pathname;if("pageview"===b.goal_type){var d=document.createElement("a");d.href=b.goal_value,l(c)===l(d.hostname+d.pathname)&&window.howuku.converted(b.test_key).then(function(){console.log("converted - page visited!")})}if("scrolling"===b.goal_type){let e=b.goal_value,t=!1;document.onscroll=(()=>{var n=r(document.body);Math.round(n)>=Number(e)&&!t&&(t=!0,window.howuku.converted(b.test_key).then(function(){console.log("converted - scrolled!")}))})}if("duration"===b.goal_type){let e=b.goal_value;setTimeout(()=>{window.howuku.converted(b.test_key).then(function(){console.log("converted - stayed for longer than "+e+" seconds!")})},1e3*e)}var u=document.createElement("a");u.href=b.element_url;let e={};try{e=JSON.parse(b.data)}catch(e){}let i=[],v="";try{Object.keys(e).forEach(function(t){v=t;let n=e[t];for(let e=0;e<n.length;e++)if(n[e].data.length){let t=n[e].data[0];t&&t.url&&i.push(t.url)}})}catch(e){console.error(e)}let _=((e,t)=>{for(let n=0;n<t.length;n++){let o=t[n],a=document.createElement("a");if(a.href=o,l(e)===l(a.hostname+a.pathname))return!0}return!1})(c,i);if(l(c)===l(u.hostname+u.pathname)||_){if("clickOnElement"===b.goal_type){let e=document.querySelector(o(b.goal_value));console.log("goal to click on element",e);let t=!1;setTimeout(()=>{e&&e.addEventListener("click",function(n){t||(n.preventDefault(),console.log("goal clicked",b.test_key),window.howuku.converted(b.test_key).then(function(){t=!0,console.log("goal completed",b.test_key),e.click()}))})},4e3)}if("formSubmit"===b.goal_type){let e=document.querySelector(o(b.goal_value));setTimeout(()=>{e&&e.addEventListener("submit",function(t){t.preventDefault(),window.howuku.converted(b.test_key).then(function(){e.submit()})})},4e3)}}var s=window.location.protocol+"//"+window.location.hostname+window.location.pathname,w=window.location.protocol+"//www."+window.location.hostname+window.location.pathname;let k=!1;try{let e=JSON.parse(b.data);k=e[s]||e[s.replace(/\/+$/,"")]||e[w]||e[w.replace(/\/+$/,"")]}catch(e){}if(k&&(window.abdata=k),!k)continue;let T=!b.is_ab;var h=null;let A=null,N=null,E=null,M=t(window.vaId,b.test_id);S&&(M=S),(null===M||T)&&a(b.seed,b.last_variant,b.test_id,b.user_data.country_code,b.traffic_allocation);var m=t(window.vaId,b.test_id);if(S&&(m=S),m){var f=null;for(let e in window.abdata)if(window.abdata[e].name===m){f=window.abdata[e].data,A=window.abdata[e].customCSS,N=window.abdata[e].customJS;break}f&&(h=f)}if(h){function g(e){return e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/\"/g,"&quot;").replace(/\'/g,"&#39;").replace(/\//g,"&#x2F;")}function p(e){return e.replace(/{{(([ ]+)?[a-z0-9_-]+([ ]+)?)}}/gi,function(e,t){return g(n(t.trim()))})}function y(e,t=null){return t?e.replace(/{{(([ ]+)?(country|city|country_flag)([ ]+)?)}}/gi,function(e,n){return g(t[n.trim()]||"")}):e}for(let e=0;e<h.length;e++){h[e].url&&(window.abRedirecting=!0,E=h[e].url,window.location.href=E);try{let t=document.querySelectorAll(h[e].target)[h[e].index];t&&h[e].textContent&&(t.textContent=h[e].textContent),t&&h[e].innerHTML&&(t.innerHTML=p(y(h[e].innerHTML.replace(/\&\#039\;/g,"'").replace(/\&\#034\;/g,'"'),b.user_data))),t&&h[e].src&&(t.src=h[e].src),t&&t instanceof HTMLElement&&h[e].style&&t.setAttribute("style",h[e].style),t&&t instanceof HTMLElement&&h[e].class&&t.setAttribute("class",h[e].class)}catch(e){console.error(e)}}}if(A){if(!document.getElementById("howu-custom-style-id")){let e=document.createElement("style");e.setAttribute("id","howu-custom-style-id"),e.setAttribute("type","text/css"),e.innerHTML=A,document.head.appendChild(e)}}if(N){if(!document.getElementById("howu-custom-script-id")){let e=document.createElement("script"),t=document.createTextNode(N);e.setAttribute("id","howu-custom-script-id"),e.setAttribute("type","text/javascript"),e.appendChild(t),document.body.appendChild(e)}}}}}window.abRedirecting});var r=function(){const e=function(){let e=document.getElementsByTagName("script"),t=0;for(;t<e.length;t++){let n=e[t];if(/(track\.min\.js)/.test(n.getAttribute("src"))&&n.getAttribute("key"))return n}}();window._H_CDN_URL=e.src?e.src.split("/")[2]:"";let t=localStorage.getItem("_abcache");t&&window.startAbTest(t),localStorage.removeItem("_abcache");let n={k:e.getAttribute("key"),h:window.location.host};a("https://api.howuku.com/widget/test","POST",n,e=>{try{"[]"!==e?window.startAbTest(e):document.body.style.opacity=1}catch(e){}})};"interactive"===t.readyState||"complete"===t.readyState||"loaded"===t.readyState?r():t.addEventListener("DOMContentLoaded",r)}(window,document);
